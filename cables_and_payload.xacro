<?xml version="1.0"?>
<!--
  Author: Massimiliano Pandolfo

  Version: 0.1
  In this initial version, the macro cable_macro successfully adds a a parent node to the node identified as uav_body_frame. The joint is continuous.
  
  TO DO:
    - implement a double revolute joint
    - fix the intertia of the cable so that it is more realistic
    - *possibly* use a revolute joint type instead of a continuous one

-->

<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <!-- Properties -->
  <xacro:property name="cable_length" value="0.7" /> <!-- [m] -->
  <xacro:property name="cable_radius" value="0.005" /> <!-- [m] -->

  <!-- Connecting the cable to a UAV -->
  <xacro:macro name="cable_macro"
    params="robot_namespace uav_body_frame id_number">
    
    <link name="${robot_namespace}/cable_${id_number}">

      <!-- RANDOM INERTIA. just for testing!!! -->
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <mass value="0.1"/>
        <inertia
          ixx="1.0" ixy="0.0" ixz="0.0"
          iyy="1.0" iyz="0.0"
          izz="1.0"/>
      </inertial>

      <visual>
        <geometry>
          <cylinder length="${cable_length}" radius="${cable_radius}"/>
        </geometry>
      </visual>

    </link>

    <!-- this first joint is a test, after it works if will be replaced by two joints and an additional link -->
    <joint name="${robot_namespace}/test_joint" type="continuous"> <!-- revolute w/o limits to the angle -->

      <!-- Placing the joint on the upper end of the cable -->
      <origin xyz="0 0 0.35" rpy="0 0 0" />

      <!-- Axis in the CHILD REFERENCE FRAME around which the rotation happens -->
      <axis xyz="1 0 0" />

      <parent link="${robot_namespace}/cable_${id_number}" />
      <child link="${uav_body_frame}" />

    </joint>

  </xacro:macro>

</robot>

<!--
<origin xyz="0 ${arm_length} ${rotor_offset_top}" rpy="0 0 0" />
-->